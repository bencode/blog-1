title: 'regularjs release v0.3.0'
date: 2015-01-11 01:44:50
tags:
---


对于还不清楚

不基于dom的好处，还有的就是，对文本进行解析是.



regularjs差不多匿迹了３个月，事实上，在过去的四个月里，Regularjs一直在实际的产品开发中使用, 据我所知共有4到5个产品的开发参与了使用，其中我参与了一个约10人前端团队的大型项目的开发,在这个项目里，主要是验证在原有公司框架NEJ基础下将Regularjs库作为数据驱动组件来部分取代传统组件的可行性，结果是乐观的，除了同事带着太多的以往字符串模板的思维来写动态模板之外，一切都在意料之中的顺利(感谢同事们让我试水).　另外还有一个较小的项目全盘使用了Regularjs构建了一个具有一定复杂度的单页面系统，__直接逼迫我火速造了[stateman]()这个轮子，并且让Regularjs可以结合它__异常优雅__的书写单页面系统了,__


最近我花了巨大的精力来重写了[API文档](),　更一目了然，并且删除了大部分的guide，以后的guide会类似于小专题的形式。而发布于乱炖的博文会更偏向于原理性和实战性.

- reference: api 和　模板语法
- guide: 小章节的指南


> 现在是时候可以开始使用Regularjs了


##重大更新一览

_`0.3.0`版本是目前为止最大的一次更新, 接下来可能会有`0.4.0`版本，但绝对不会有`0.5.0`了，而是会直接过渡到`1.0.0`版本._


### 1. 允许修改模板符号，将默认模板符号从`{{}}`修改为`{}`

这应该是最大的一个改动，由于Regularjs的词法部分基于正则(而不是逐字符ll)，这个改动其实还是耗费了我一点时间。

敢做这么大胆的修改的考虑还是相信目前正式在使用Regularjs的除了公司内部，仍然是少数(冷门的好处). 并且也提供了配置来返回原语法.

为什么这么做？因为简洁, 基于完整语法解析的模板根本无需去考虑　{} 与表达式里的冲突问题. 组件最佳实践肯定需要静态化，所以与服务器模板冲突的可能性也很小，上线基本都是预解析了. 话说其实　{{}}的模板其实反而跟多。改动之后更像JST模板了.


### 2. 借着修改模板符号春风，提供了对browserify与requirejs以及NEJ的插件支持，使得你可以在各个模块系统中方便的引用模板和预处理.　

__requirejs__

```js
define(function(require, module, exports){

  var template = require("rgl!path/to/template.html");
  var Regular = require("regularjs");
  var Component = Regular.extend([
    template: template
  ])

  module.exports = Component;
})

```

__browserify__

```js

var template = require("path/to/template.rgl");

```

__NEJ__

```js
define([
"regular!path/to/template.html"
], function(template){
  
})

```

### 3. 抑制可控安全的表达式错误

### 4. 提供了节点和组件引用ref

### 5. 提供了移除组件(不销毁)和组件失效的接口

### 6. 提供了制作单页面系统的regular-state　路由系统


这个功能事实上基于stateman,　一个基于状态的routing库，　我不想去阐述引入多级状态的必要性，这个我会另写一篇介绍stateman的文章, 只想说类似Backbone的路由已经不再适用于当前的开发，director.js这种伪层级路由也经不起考量，这些都需要你真正参与过一定复杂度单页系统的开发才能得到的体会，你最终还是会走向层级的抽象. ui-router的这种基于状态抽象的多级路由才是正确的道路。不过它紧密耦合了angularjs,  并且也太巨，我没忍住就又造了个轮子, 这个轮子也是支持IE6+,　10kb的size(未gzip).

我们先来简单看个demo.　这个我会立马写一篇教程出来


### 8. two-way filters

vuejs huoqu linggan, danshi faxian zao you kuangjia jiu zheme zuo le.


0.3.0





## Todo

目前的版本仍然支持IE6.　对于前端来讲，这不是一件值得称道的事情，而是演变为一件羞耻的事情(虽然因此引入的脏代码并不多，除非不支持IE8)　,但是对于Regularjs而言，在网易内部能推广生存下去才是持续更新的原动力，毕竟我是带薪在开发Regularjs　.目前的产品最少最少需要支持IE8, 事实上大部分都至少要求IE6下可用，妥协的其实只是界面样式。



0. 抽离一个不支持低版本IE的版本

1. 表达式的依赖收集,　方便未来切换到 脏检查+Object.observe.

这个其实语法层面已经做了,由于Object.observe本身是异步的，所以会让部分流程异步化.　为何脏检查无法完全避免,　是因为表达式的，我无法知道类似
`this.todos().message`对应的什么对象. 目前的想法是，如果我能确定则使用observer，否则进入脏检查，

2. Regularjs + stateman的SPA的SEO优化

虽然活动模板相较于早已烂大街的字符串模板和即将烂大街的dom-based的mvvm模板库, 目前其实并不多见,但要挑战的对象真的都很强 React(由特性来讲，姑且算一类),Ractive,htmlbars. 基本都有大量的社区支持， 但是都没有得出杀手级的解决方案，只有把难啃的骨头啃下了才有突破的可能性.


由于之前提到了，Regularjs是不依赖与Dom的解析的，所以其实是可以在服务端生成字符串的. 

stateman + Regularjs 在经过我思考后是有可能__保证在原配置代码不变的前提下,在任意复杂度__的ＳＰＡ系统里，达到对爬虫的友好的.(缺点是产生的页面是静态的). 这个也注定只有这两种组合可以，在这一点上，基本上Vuejs、Avalon、Angular就只能围观了,　基本不需要去考虑可能性的问题，因为完全不可能(phantomjs?).


3. 动画系统的再整理思考，这个是未来的趋势. 思考也和前面基本一致，尽量不与数据绑定发生强耦合，数据绑定真的很脆弱，事件驱动的触发. 可组合级联，多节点、组件间的联动

【DEMO】目前的效果

3. 常用组件

这个万年坑，因为一己之力难以实现，我会先提供几个最常用的例子，比如datepicker翻页器等.



4. element的全面支持切入.　利用已有组件自动包装为custom element.
Regularjs的生存之道就是在各种标准技术火之前去抱个大腿. 少让之前辛苦写的组件可以重用上. 


5. 全面的布道的文章, 虽然酒香不怕巷子深，
dev.io申请了没让通过，估计还是会发表在乱炖里. 事实上小众的社区可能也不利于推广.

6. 模板的微调




最后再

1. 带薪工作中开发，而不仅仅是工作之余, 解决了作者跑路的危险性.
2. 作者仍然是属于得优先做产品，其次才是沉淀技术方案，所以是带有实际合理性的.





> 不做框架，做个好库 .

